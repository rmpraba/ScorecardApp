
<link rel="import" href="..\..\bower_components/polymer/polymer.html">

<dom-module id="co-scholastic-service">
  <template>
  <iron-ajax        
        id="academicajax"
        url="../../configfile/academicconfig.json"
        params="{{academicparam}}"
        handle-as="json"
        content-type="application/json"
        on-response="academicResponse"
        debounce-duration="300"
    >
  <iron-ajax
        method="post"
        id="assesmentajax"
        url="{{assesmenturl}}"
        params="{{assesmentparam}}"
        handle-as="json"
        content-type="application/json"
        on-response="assesmentResponse"
        debounce-duration="300"
    >
  <iron-ajax
        method="post"
        id="termajax"
        url="{{termurl}}"
        params="{{termparam}}"
        handle-as="json"
        content-type="application/json"
        on-response="termResponse"
        debounce-duration="300"
    >
  <iron-ajax
        method="post"
        id="termcycleajax"
        url="{{termcycleurl}}"
        params="{{termcycleparam}}"
        handle-as="json"
        content-type="application/json"
        on-response="termcycleResponse"
        debounce-duration="300"
    >
  <iron-ajax
        method="post"
        id="gradeajax"
        url="{{gradeurl}}"
        params="{{gradeparam}}"
        handle-as="json"
        content-type="application/json"
        on-response="gradeResponse"
        debounce-duration="300"
    >
    <iron-ajax
        method="post"
        id="sectionajax"
        url="{{sectionurl}}"
        params="{{sectionparam}}"
        handle-as="json"
        content-type="application/json"
        on-response="sectionResponse"
        debounce-duration="300"
    >
    <iron-ajax
        method="post"
        id="fetchstudentajax"
        url="{{fetchstudenturl}}"
        params="{{fetchstudentparam}}"
        handle-as="json"
        content-type="application/json"
        on-response="fetchstudentResponse"
        debounce-duration="300"
    >
   <iron-ajax        
        method="post"
        id="fetchlifeskillajax"
        url="{{fetchlifeskillurl}}"
        params="{{fetchlifeskillparam}}"
        handle-as="json"
        content-type="application/json"
        on-response="fetchlifeskillResponse"
        debounce-duration="300"
    >

    <iron-ajax
        method="post"
        id="insertcoassesmentmarkajax"
        url="{{insertcoassesmentmarkurl}}"
        params="{{insertcoassesmentmarkparam}}"
        handle-as="json"
        content-type="application/json"
        on-response="insertcoassesmentmarkResponse"
        debounce-duration="300"
    >
    <iron-ajax
        method="post"
        id="insertattendanceajax"
        url="{{insertattendanceurl}}"
        params="{{insertattendanceparam}}"
        handle-as="json"
        content-type="application/json"
        on-response="insertattendanceResponse"
        debounce-duration="300"
    >
    <iron-ajax
        method="post"
        id="inserthealthajax"
        url="{{inserthealthurl}}"
        params="{{inserthealthparam}}"
        handle-as="json"
        content-type="application/json"
        on-response="inserthealthResponse"
        debounce-duration="300"
    >
    <iron-ajax
        method="post"
        id="fetchworkingdaysajax"
        url="{{fetchworkingdaysurl}}"
        params="{{fetchworkingdaysparam}}"
        handle-as="json"
        content-type="application/json"
        on-response="fetchworkingdaysResponse"
        debounce-duration="300"
    >
    
  </template>
  <script>
  (function() {
    'use strict';

    Polymer({
      is: 'co-scholastic-service',
      callWorkingdaysService:function(){
        this.fetchworkingdaysurl=sessionStorage.getItem("addrinfo")+"/fetchworkingdays-service";
        var obj={"academicyear":"","schoolid":"","termname":"","type":""};
        obj.academicyear=localStorage.getItem("curr_sess_academicyear");
        obj.schoolid=sessionStorage.getItem("curr_sess_loggedschoolid");
        obj.termname=localStorage.getItem("curr_sess_termname");
         if(localStorage.getItem("curr_sess_grade")=="Grade-1"||localStorage.getItem("curr_sess_grade")=="Grade-2"||localStorage.getItem("curr_sess_grade")=="Grade-3"||localStorage.getItem("curr_sess_grade")=="Grade-4"){
         obj.type='Pre-Primary';
         }
         else{
         obj.type='Primary';
         }
        // alert(JSON.stringify(obj));
        this.fetchworkingdaysparam=obj;
        this.$.fetchworkingdaysajax.generateRequest();
      },
      fetchworkingdaysResponse:function(e){
        var warr=e.detail.response.returnval;  
        // alert(JSON.stringify(warr));      
        document.querySelector('attendance-card').setWorkingDays(warr[0].no_of_days);
      },
      callAcademicService:function(){
        this.$.academicajax.generateRequest();
      },
      academicResponse:function(e){              
        document.querySelector('coscholastic-assesment-card').academicarr=e.detail.response;
      },
      callTermService:function(termtype){
         this.termurl=sessionStorage.getItem("addrinfo")+"/term-service";
         var obj={"schoolid":"","termtype":""};
         obj.schoolid=sessionStorage.getItem("curr_sess_loggedschoolid");
         obj.termtype=termtype;
         this.termparam= obj;
         this.$.termajax.generateRequest();
      },
      termResponse:function(e){         
         document.querySelector('teacherhome-card').termarr=e.detail.response.returnval;
         document.querySelector('teacherhome-card').FnToggle();
      },
      callGradeService:function(){
         this.gradeurl=sessionStorage.getItem("addrinfo")+"/grade-service";
         var obj={"schoolid":"","loggedid":""};
         obj.schoolid=sessionStorage.getItem("curr_sess_loggedschoolid");
         obj.loggedid=sessionStorage.getItem("curr_sess_loggedid");
         this.gradeparam= obj;
         this.$.gradeajax.generateRequest();
      },
      gradeResponse:function(e){
          document.querySelector('coscholastic-assesment-card').gradearr=e.detail.response.returnval;
      },
      callSectionService:function(gradename){        
         this.sectionurl=sessionStorage.getItem("addrinfo")+"/section-service";
         var obj={"schoolid":"","loggedid":"","gradename":""};
         obj.schoolid=sessionStorage.getItem("curr_sess_loggedschoolid");
         obj.loggedid=sessionStorage.getItem("curr_sess_loggedid");
         obj.gradename=gradename;
         this.sectionparam= obj;
         this.$.sectionajax.generateRequest();
      },
      sectionResponse:function(e){        
         document.querySelector('coscholastic-assesment-card').sectionarr=e.detail.response.returnval; 
      },
      callFetchStudentInfo:function(grade,section){
         this.fetchstudenturl=sessionStorage.getItem("addrinfo")+"/fetchstudent-service";
         var obj={"schoolid":"","gradename":"","section":"","subject":""};
         obj.schoolid=sessionStorage.getItem("curr_sess_loggedschoolid");
         obj.gradename=grade;
         obj.section=section;
         obj.subject=localStorage.getItem("curr_sess_coscholastic_category");
         this.fetchstudentparam= obj;
         // alert(JSON.stringify(obj));
         this.$.fetchstudentajax.generateRequest();
      },
      fetchstudentResponse:function(e){         
        var arr=e.detail.response.returnval;        
        for(var i=0;i<arr.length;i++){
          arr[i].serialno=parseInt(i)+1;
        }
        if(localStorage.getItem("curr_sess_coscholastic_category")=="Health"){
        document.querySelector('cce-fivetoten-health-card').studarr=arr;           
        } 
        else if(localStorage.getItem("curr_sess_coscholastic_category")=="Attendance"){            
        document.querySelector('attendance-card').studarr=arr;                 
        }        
        else if(localStorage.getItem("curr_sess_coscholastic_category")=="Life Skills"){
        if(localStorage.getItem("curr_sess_grade")=="Grade-9"||localStorage.getItem("curr_sess_grade")=="Grade-10")
        document.querySelector('cc-ntlife-skill-card').studarr=arr;
        else
        document.querySelector('cs-life-skill-card').studarr=arr;    
        }
        else if(localStorage.getItem("curr_sess_coscholastic_category")=="Work Education"){
        document.querySelector('cs-education-card').studarr=arr;        
        }
        else if(localStorage.getItem("curr_sess_coscholastic_category")=="Visual & Performing Arts"){
        document.querySelector('cs-visual-performing-card').studarr=arr;       
        // document.querySelector('cs-visualerforming-card').studarr=arr;   
        }
        else if(localStorage.getItem("curr_sess_coscholastic_category")=="Attitudes & Values"){
        document.querySelector('cs-attitudes-card').studarr=arr;        
        }
        else if(localStorage.getItem("curr_sess_coscholastic_category")=="Co-Curricular Activities"){
        document.querySelector('cs-co-curricular-card').studarr=arr;        
        }
        else if(localStorage.getItem("curr_sess_coscholastic_category")=="Health & Physical Activities"){
        document.querySelector('cs-health-physical-education-card').studarr=arr;         
        }         
      },
      fetchlifeskilldata:function(name)
      {
         this.fetchlifeskillurl=sessionStorage.getItem("addrinfo")+"/fetchlifeskill";
         var obj={"schoolid":"","termtype":""};
         obj.schoolid=sessionStorage.getItem("curr_sess_loggedschoolid");
         obj.termtype=name;        
         this.fetchlifeskillparam= obj;
         this.$.fetchlifeskillajax.generateRequest();
      },
      fetchlifeskillResponse:function(e)
      {
        var coarr=e.detail.response.returnval;
        // alert(JSON.stringify(coarr));
        var cat=sessionStorage.getItem("category");
        // alert(cat);
        if(cat=="lifeskill"){
        // alert(localStorage.getItem("curr_sess_grade"));
        if(localStorage.getItem("curr_sess_grade")=="Grade-9"||localStorage.getItem("curr_sess_grade")=="Grade-10")
        document.querySelector('cc-ntlife-skill-itemcard').coarr=coarr;
        else
        document.querySelector('cs-life-skill-item-card').coarr=coarr;
        } 
        else  if(cat=="education")
        document.querySelector('cs-education-item-card').coarr=coarr;
        else  if(cat=="visual")
        document.querySelector('cs-visual-performing-item-card').coarr=coarr;
        else  if(cat=="cocurricular")
        document.querySelector('cs-co-curricular-item-card').coarr=coarr;
        else  if(cat=="healthandphysical")
        document.querySelector('cs-health-physical-education-item-card').coarr=coarr;
        else  if(cat=="attitude")
        document.querySelector('cs-attitudes-item-card').coarr=coarr;        
      },
      callinsertcoscholasticassesmentmarkService:function(studid,studname,category,subcategory,mark){
         this.insertcoassesmentmarkurl=sessionStorage.getItem("addrinfo")+"/insertcoassesmentmark-service";
         var obj={"schoolid":"","academicyear":"","assesmentid":"","classid":"","studentid":"","studentname":"","termname":"","grade":"","section":"","subject":"","category":"","subcategory":"","mark":"","total":"","assesmentflag":""};
         obj.schoolid=sessionStorage.getItem("curr_sess_loggedschoolid");
         obj.academicyear=localStorage.getItem("curr_sess_academicyear");
         obj.assesmentid=localStorage.getItem("curr_sess_assesment");
         obj.termname=localStorage.getItem("curr_sess_termname");
         obj.classid=sessionStorage.getItem("curr_sess_classid");
         obj.studentid=studid;
         obj.studentname=studname;        
         obj.grade=localStorage.getItem("curr_sess_grade");
         obj.section=localStorage.getItem("curr_sess_section");
         obj.subject=localStorage.getItem("curr_sess_subject");
         obj.category=category;
         obj.subcategory=subcategory;
         obj.mark=mark;         
         this.insertcoassesmentmarkparam= obj;        
         this.$.insertcoassesmentmarkajax.generateRequest();
      },
      insertcoassesmentmarkResponse:function(e){
        alert(e.detail.response.returnval);
      },
      callinsertattendanceService:function(studid,studname,attendance,workingdays){
        this.insertattendanceurl=sessionStorage.getItem("addrinfo")+"/insertattendance-service";
         var obj={"schoolid":"","academicyear":"","assesmentid":"","classid":"","studentid":"","studentname":"","termname":"","grade":"","section":"","attendance":"","workingdays":""};
         obj.schoolid=sessionStorage.getItem("curr_sess_loggedschoolid");
         obj.academicyear=localStorage.getItem("curr_sess_academicyear");
         obj.termname=localStorage.getItem("curr_sess_termname");
         obj.classid=sessionStorage.getItem("curr_sess_classid");
         obj.studentid=studid;
         obj.studentname=studname;        
         obj.grade=localStorage.getItem("curr_sess_grade");;
         obj.section=localStorage.getItem("curr_sess_section");
         obj.attendance=attendance;
         obj.workingdays=workingdays;         
         this.insertattendanceparam= obj;        
         this.$.insertattendanceajax.generateRequest();
      },
      insertattendanceResponse:function(e){
        //alert(e.detail.response.returnval);
        if(e.detail.response.returnval=="succ")
          alert("Inserted!");
      },
      callinserthealthService:function(studid,studname,height,weight,bloodgroup,visionleft,visionright,dental){
         this.inserthealthurl=sessionStorage.getItem("addrinfo")+"/inserthealth-service";
         var obj={"schoolid":"","academicyear":"","assesmentid":"","classid":"","studentid":"","studentname":"","termname":"","grade":"","section":"","subject":"","height":"","weight":"","bloodgroup":"","visionleft":"","visionright":"","dental":""};
         obj.schoolid=sessionStorage.getItem("curr_sess_loggedschoolid");
         obj.academicyear=localStorage.getItem("curr_sess_academicyear");
         // obj.assesmentid=localStorage.getItem("curr_sess_assesment");
         obj.termname=localStorage.getItem("curr_sess_termname");
         obj.classid=sessionStorage.getItem("curr_sess_classid");
         obj.studentid=studid;
         obj.studentname=studname;        
         obj.grade=localStorage.getItem("curr_sess_grade");;
         obj.section=localStorage.getItem("curr_sess_section");
         // obj.subject=localStorage.getItem("curr_sess_subject");
         obj.height=height;
         obj.weight=weight;
         obj.bloodgroup=bloodgroup;         
         obj.visionleft=visionleft;         
         obj.visionright=visionright;         
         obj.dental=dental;         
         this.inserthealthparam= obj;        
         this.$.inserthealthajax.generateRequest();
      },
      inserthealthResponse:function(e){
        alert(e.detail.response.returnval);
      }     
    });
  })();
  </script>
</dom-module>
