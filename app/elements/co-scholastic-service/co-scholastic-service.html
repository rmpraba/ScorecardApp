
<link rel="import" href="..\..\bower_components/polymer/polymer.html">

<dom-module id="co-scholastic-service">
  <template>
  <iron-ajax        
        id="academicajax"
        url="../../configfile/academicconfig.json"
        params="{{academicparam}}"
        handle-as="json"
        content-type="application/json"
        on-response="academicResponse"
        debounce-duration="300"
    >
  <iron-ajax
        method="post"
        id="assesmentajax"
        url="{{assesmenturl}}"
        params="{{assesmentparam}}"
        handle-as="json"
        content-type="application/json"
        on-response="assesmentResponse"
        debounce-duration="300"
    >
  <iron-ajax
        method="post"
        id="termajax"
        url="{{termurl}}"
        params="{{termparam}}"
        handle-as="json"
        content-type="application/json"
        on-response="termResponse"
        debounce-duration="300"
    >
  <iron-ajax
        method="post"
        id="termcycleajax"
        url="{{termcycleurl}}"
        params="{{termcycleparam}}"
        handle-as="json"
        content-type="application/json"
        on-response="termcycleResponse"
        debounce-duration="300"
    >
  <iron-ajax
        method="post"
        id="gradeajax"
        url="{{gradeurl}}"
        params="{{gradeparam}}"
        handle-as="json"
        content-type="application/json"
        on-response="gradeResponse"
        debounce-duration="300"
    >
    <iron-ajax
        method="post"
        id="sectionajax"
        url="{{sectionurl}}"
        params="{{sectionparam}}"
        handle-as="json"
        content-type="application/json"
        on-response="sectionResponse"
        debounce-duration="300"
    >
    <iron-ajax
        method="post"
        id="fetchstudentajax"
        url="{{fetchstudenturl}}"
        params="{{fetchstudentparam}}"
        handle-as="json"
        content-type="application/json"
        on-response="fetchstudentResponse"
        debounce-duration="300"
    >
   <iron-ajax        
        method="post"
        id="fetchlifeskillajax"
        url="{{fetchlifeskillurl}}"
        params="{{fetchlifeskillparam}}"
        handle-as="json"
        content-type="application/json"
        on-response="fetchlifeskillResponse"
        debounce-duration="300"
    >

    <iron-ajax
        method="post"
        id="insertcoassesmentmarkajax"
        url="{{insertcoassesmentmarkurl}}"
        params="{{insertcoassesmentmarkparam}}"
        handle-as="json"
        content-type="application/json"
        on-response="insertcoassesmentmarkResponse"
        debounce-duration="300"
    >
    
  </template>
  <script>
  (function() {
    'use strict';

    Polymer({
      is: 'co-scholastic-service',
      callAcademicService:function(){
        this.$.academicajax.generateRequest();
      },
      academicResponse:function(e){              
        document.querySelector('coscholastic-assesment-card').academicarr=e.detail.response;
      },
      callTermService:function(termtype){
         this.termurl=sessionStorage.getItem("addrinfo")+"/term-service";
         var obj={"schoolid":"","termtype":""};
         obj.schoolid=sessionStorage.getItem("curr_sess_loggedschoolid");
         obj.termtype=termtype;
         this.termparam= obj;
         this.$.termajax.generateRequest();
      },
      termResponse:function(e){         
         document.querySelector('teacherhome-card').termarr=e.detail.response.returnval;
         document.querySelector('teacherhome-card').FnToggle();
      },
      callGradeService:function(){
         this.gradeurl=sessionStorage.getItem("addrinfo")+"/grade-service";
         var obj={"schoolid":"","loggedid":""};
         obj.schoolid=sessionStorage.getItem("curr_sess_loggedschoolid");
         obj.loggedid=sessionStorage.getItem("curr_sess_loggedid");
         this.gradeparam= obj;
         this.$.gradeajax.generateRequest();
      },
      gradeResponse:function(e){
          document.querySelector('coscholastic-assesment-card').gradearr=e.detail.response.returnval;
      },
      callSectionService:function(gradename){        
         this.sectionurl=sessionStorage.getItem("addrinfo")+"/section-service";
         var obj={"schoolid":"","loggedid":"","gradename":""};
         obj.schoolid=sessionStorage.getItem("curr_sess_loggedschoolid");
         obj.loggedid=sessionStorage.getItem("curr_sess_loggedid");
         obj.gradename=gradename;
         this.sectionparam= obj;
         this.$.sectionajax.generateRequest();
      },
      sectionResponse:function(e){        
         document.querySelector('coscholastic-assesment-card').sectionarr=e.detail.response.returnval; 
      },
      callFetchStudentInfo:function(grade,section){
         this.fetchstudenturl=sessionStorage.getItem("addrinfo")+"/fetchstudent-service";
         var obj={"schoolid":"","gradename":"","section":""};
         obj.schoolid=sessionStorage.getItem("curr_sess_loggedschoolid");
         obj.gradename=grade;
         obj.section=section;
         this.fetchstudentparam= obj;
         // alert(JSON.stringify(obj));
         this.$.fetchstudentajax.generateRequest();
      },
      fetchstudentResponse:function(e){         
        var arr=e.detail.response.returnval;  
        // alert(JSON.stringify(arr));       
        for(var i=0;i<arr.length;i++){
          arr[i].serialno=i+1;
        }
        alert(localStorage.getItem("curr_sess_coscholastic_category"));
         if(localStorage.getItem("curr_sess_coscholastic_category")=="Health"){
          document.querySelector('cce-fivetoten-health-card').studarr=arr;
           
          } 
          if(localStorage.getItem("curr_sess_coscholastic_category")=="Attendance"){
            alert('attendance'+document.querySelector('cce-fivetoten-attendance-card'));
          document.querySelector('cce-fivetoten-attendance-card').studarr=arr; 
          alert('attendance'+JSON.stringify(document.querySelector('cce-fivetoten-attendance-card').studarr));         
          }         
      },

fetchlifeskilldata:function(name)
{
   this.fetchlifeskillurl=sessionStorage.getItem("addrinfo")+"/fetchlifeskill";
         var obj={"schoolid":"","termtype":""};
         obj.schoolid=sessionStorage.getItem("curr_sess_loggedschoolid");
         obj.termtype=name;        
         this.fetchlifeskillparam= obj;
         this.$.fetchlifeskillajax.generateRequest();
},
fetchlifeskillResponse:function(e)
{
  var coarr=e.detail.response.returnval;
  var cat=sessionStorage.getItem("category");
      if(cat=="lifeskill")
  document.querySelector('cs-life-skill-item-card').coarr=coarr; 
else  if(cat=="education")
  document.querySelector('cs-education-item-card').coarr=coarr;
else  if(cat=="visual")
  document.querySelector('cs-visual-performing-item-card').coarr=coarr;
else  if(cat=="cocurricular")
  document.querySelector('cs-co-curricular-item-card').coarr=coarr;
else  if(cat=="healthandphysical")
  document.querySelector('cs-health-physical-education-item-card').coarr=coarr;
  else  if(cat=="attitude")
  document.querySelector('cs-attitudes-item-card').coarr=coarr;
//alert(JSON.stringify(e.detail.response.returnval));

},
callinsertcoscholasticassesmentmarkService:function(studid,studname,category,subcategory,mark){
         this.insertcoassesmentmarkurl=sessionStorage.getItem("addrinfo")+"/insertcoassesmentmark-service";
         var obj={"schoolid":"","academicyear":"","assesmentid":"","classid":"","studentid":"","studentname":"","termname":"","grade":"","section":"","subject":"","category":"","subcategory":"","mark":"","total":"","assesmentflag":""};
         obj.schoolid=sessionStorage.getItem("curr_sess_loggedschoolid");
         obj.academicyear=localStorage.getItem("curr_sess_academicyear");
         obj.assesmentid=localStorage.getItem("curr_sess_assesment");
         obj.termname=localStorage.getItem("curr_sess_termname");
         obj.classid=sessionStorage.getItem("curr_sess_classid");
         obj.studentid=studid;
         obj.studentname=studname;        
         obj.grade=localStorage.getItem("curr_sess_grade");;
         obj.section=localStorage.getItem("curr_sess_section");
         obj.subject=localStorage.getItem("curr_sess_subject");
         obj.category=category;
         obj.subcategory=subcategory;
         obj.mark=mark;         
         this.insertcoassesmentmarkparam= obj;        
         this.$.insertcoassesmentmarkajax.generateRequest();
      }
     
    });
  })();
  </script>
</dom-module>
